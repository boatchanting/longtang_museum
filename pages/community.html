<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>社区广场</title>
  <!-- 主题样式占位，供脚本切换深浅色 -->
  <style id="theme-style">
    :root {
      --grad-start: #f6e7cd;
      --grad-end:   #dfc295;
      --primary:    #b07a43;
      --text:       #4d3a13;
      --card:       #fff8ef;
      --card-dark:  #4d402d;
    }
  </style>
  <style>
    @font-face { font-family: "Segoe UI"; src: local("Segoe UI"); }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      height: 100%;
      font-family: "Segoe UI","PingFang SC","Noto Sans",sans-serif;
      background: linear-gradient(to top, var(--grad-end), var(--grad-start));
      color: var(--text);
      display: flex;
      flex-direction: column;
    }
    .card {
      background: var(--card);
      border-radius: 24px;
      box-shadow: 0 3px 10px rgba(0,0,0,.08);
    }
    header {
      padding: 1rem;
      text-align: center;
      background: var(--card);
      border-radius: 0 0 24px 24px;
      box-shadow: 0 2px 8px rgba(0,0,0,.06);
    }
    header h1 { font-size: 1.3rem; font-weight: 700; }
    main {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
    }
    /* 瀑布流两列 */
    .feed {
      column-count: 2;
      column-gap: 0.5rem;
    }
    .post-card {
      display: inline-block;
      width: 100%;
      margin-bottom: 0.5rem;
      position: relative;
    }
    .post-card img {
      width: 100%;
      aspect-ratio: 4/5;
      object-fit: cover;
      border-radius: 16px;
    }
    .view-count {
      position: absolute;
      bottom: 8px; right: 8px;
      background: rgba(0,0,0,0.4);
      color: #fff;
      padding: 2px 6px;
      border-radius: 12px;
      font-size: .75rem;
    }
    .btn-add {
      position: fixed;
      right: 1rem; bottom: 5.5rem;
      width: 3.6rem; height: 3.6rem;
      border-radius: 50%;
      background: #e63946;
      color: #fff;
      font-size: 2rem;
      line-height: 3.6rem;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,.2);
      cursor: pointer;
    }
    .bottom-nav {
      position: fixed;
      left: 0; bottom: 0;
      width: 100%; height: 4.2rem;
      background: var(--card);
      border-radius: 24px 24px 0 0;
      box-shadow: 0 -3px 10px rgba(0,0,0,.08);
      display: flex;
      justify-content: space-around;
      align-items: center;
    }
    .nav-item {
      flex: 1;
      text-align: center;
      color: var(--primary);
      text-decoration: none;
      font-size: .8rem;
    }
    .nav-item.active { color: var(--text); }
    .nav-item .icon {
      width: 1.6rem; height: 1.6rem;
      margin: 0 auto .1rem;
      display: block;
    }
    /* 导航项<a>标签样式 */
    a.nav-item { /* 应用于作为链接的导航项 */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 12px;
        color: #555; /* 链接的默认颜色 */
        text-decoration: none !important; /* 关键：移除下划线，!important确保覆盖默认样式 */
        flex: 1;
        text-align: center;
        padding: 5px 0;
        transition: color 0.2s ease-in-out;
    }
  </style>
</head>
<body>

  <header class="card">
    <h1>社区广场</h1>
  </header>

  <main>
    <div class="feed" id="feed">
      <!-- 示例：后续动态加载 -->
      <div class="post-card card">
        <img src="https://picsum.photos/200/250?random=1" alt="">
        <div class="view-count">👁 123</div>
      </div>
      <div class="post-card card">
        <img src="https://picsum.photos/200/250?random=2" alt="">
        <div class="view-count">👁 98</div>
      </div>
      <div class="post-card card">
      <img src="https://picsum.photos/200/250?random=3" alt="">
      <div class="view-count">👁 45</div>
    </div>
    <div class="post-card card">
      <img src="https://picsum.photos/200/250?random=4" alt="">
      <div class="view-count">👁 67</div>
    </div>
    <div class="post-card card">
      <img src="https://picsum.photos/200/250?random=5" alt="">
      <div class="view-count">👁 23</div>
    </div>
    <div class="post-card card">
      <img src="https://picsum.photos/200/250?random=6" alt="">
      <div class="view-count">👁 89</div>
    </div>
    <div class="post-card card">
      <img src="https://picsum.photos/200/250?random=7" alt="">
      <div class="view-count">👁 34</div>
    </div>
    <div class="post-card card">
      <img src="https://picsum.photos/200/250?random=8" alt="">
      <div class="view-count">👁 56</div>
    </div>
    </div>    
  </main>

  <div class="btn-add" onclick="location.href='publish.html'">＋</div>

  <footer class="bottom-nav card">
    <a class="nav-item" href="../index.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
      </svg>
      <div>主页</div>
    </a>
    <a class="nav-item" href="#" onclick="artifact.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/>
      </svg>
      <div>馆藏</div>
    </a>
    <a class="nav-item active" href="community.html">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
      </svg>
      <div>社区</div>
    </a>
    <a class="nav-item" href="#" onclick="/* TODO */">
      <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
      </svg>
      <div>我的</div>
    </a>
  </footer>

  <script>
    // 下拉刷新
    let startY = 0;
    document.addEventListener('touchstart', e => { startY = e.touches[0].clientY; });
    document.addEventListener('touchend', e => {
      if (window.scrollY === 0 && e.changedTouches[0].clientY - startY > 80) {
        location.reload();
      }
    });
    // 上滑分页加载
    window.addEventListener('scroll', () => {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 50) {
        // TODO: 加载更多动态
      }
    });
    // 点击卡片跳转详情
    document.getElementById('feed').addEventListener('click', e => {
      const card = e.target.closest('.post-card');
      if (card) location.href = 'detail.html';
    });

    // 主题切换逻辑（与首页一致）
    (function(){
      const style = document.getElementById('theme-style');
      const light = `
        --grad-start:#f6e7cd;
        --grad-end:#dfc295;
        --primary:#b07a43;
        --text:#4d3a13;
        --card:#fff8ef;
      `;
      const dark = `
        --grad-start:#3f3425;
        --grad-end:#241e14;
        --primary:#e0b67a;
        --text:#f5f0ea;
        --card:#4d402d;
      `;
      const mq = matchMedia('(prefers-color-scheme:dark)');
      function apply(mode) {
        style.textContent = `:root{${mode==='dark'?dark:mode==='light'?light:(mq.matches?dark:light)}}`;
      }
      const saved = localStorage.getItem('museumTheme') || 'auto';
      apply(saved);
      mq.addEventListener('change', () => {
        if ((localStorage.getItem('museumTheme')||'auto') === 'auto') {
          apply('auto');
        }
      });
      window.setTheme = mode => {
        localStorage.setItem('museumTheme', mode);
        apply(mode);
      };
    })();
  </script>
</body>
</html>
